generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

/// Arena Model
model Arena {
  // Primary Key - Using UUID for a robust, auto-generated ID
  id   String @id @default(uuid())
  name String

  // Relationship to Match: An Arena can host many Matches
  matches Match[]
}

// ---

/// Status Model
model Status {
  // Primary Key - Using Int as specified, auto-incremented
  id   String @id @default(uuid())
  name String @unique // Status names are usually unique

  // Relationship to Match: A Status can apply to many Matches
  matches Match[]
}

// team model
model Team {
  // Primary Key - Using Int as specified, auto-incremented
  id   String @id @default(uuid())
  name String

  // Relationship to TeamMatch: A Team can participate in many Matches
  teamMatches TeamMatch[]

  //RelationW to Participant: One Team can have many participant
  participants Participant[]

  @@index([id])
}

//Category Model
model Category {
  id   String @id @default(uuid())
  name String

  // Relation to Team: One catgory can have many participant
  participants Participant[]

  @@index([id])
}


// Participant Model
model Participant {
  id     String @id @default(uuid())
  name   String
  teamId String
  //Relation to Team: One participant can only have one team only
  team   Team   @relation(fields: [teamId], references: [id])

  // Relation to Category
  categoryId String
  category Category @relation(fields: [categoryId], references: [id])

  @@index([categoryId, teamId])
}


/// Match Model
model Match {
  // Primary Key - Using UUID for a robust, auto-generated ID
  id        String   @id @default(uuid())
  bout      String
  createdAt DateTime @default(now())
  editedAt  DateTime @updatedAt

  // Foreign Key to Arena
  arenaId String // Foreign keys should match the type of the primary key (Arena.id is String)
  arena   Arena  @relation(fields: [arenaId], references: [id])

  // Foreign Key to Status
  statusId String
  status   Status @relation(fields: [statusId], references: [id])

  // Relationship to TeamMatch: A Match can have many TeamMatch records
  teamMatches TeamMatch[]

  // Indexing on Foreign Keys for faster lookups/joins
  @@index([arenaId])
  @@index([statusId])
}

// ---

/// TeamMatch Model (Junction Table)
model TeamMatch {
  // Primary Key - Using Int as specified, auto-incremented
  id String @id @default(uuid())

  // Foreign Key to Match
  matchId String
  match   Match  @relation(fields: [matchId], references: [id])

  teamId String
  team   Team   @relation(fields: [teamId], references: [id])

  // Optional: Composite unique constraint if a team can only be associated once per match
  // @@unique([matchId, teamId])

  // Indexing on Foreign Keys for faster lookups/joins
  @@index([matchId])
  @@index([teamId])
}
