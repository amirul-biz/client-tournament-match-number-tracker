// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}



/// Arena Model
model Arena {
  // Primary Key - Using UUID for a robust, auto-generated ID
  id    String @id @default(uuid())
  name  String

  // Relationship to Match: An Arena can host many Matches
  matches Match[]
}

// ---

/// Status Model
model Status {
  // Primary Key - Using Int as specified, auto-incremented
  id    Int    @id @default(autoincrement())
  name  String @unique // Status names are usually unique

  // Relationship to Match: A Status can apply to many Matches
  matches Match[]
}

// team model
model Team{
  // Primary Key - Using Int as specified, auto-incremented
  id    Int    @id @default(autoincrement())
  name  String

  // Relationship to TeamMatch: A Team can participate in many Matches
  teamMatches TeamMatch[]
}

/// Match Model
model Match {
  // Primary Key - Using UUID for a robust, auto-generated ID
  id          String    @id @default(uuid())
  bout        String
  createdAt   DateTime  @default(now())
  editedAt    DateTime  @updatedAt

  // Foreign Key to Arena
  arenaId     String // Foreign keys should match the type of the primary key (Arena.id is String)
  arena       Arena   @relation(fields: [arenaId], references: [id])

  // Foreign Key to Status
  statusId    Int
  status      Status  @relation(fields: [statusId], references: [id])

  // Relationship to TeamMatch: A Match can have many TeamMatch records
  teamMatches TeamMatch[]

  // Indexing on Foreign Keys for faster lookups/joins
  @@index([arenaId])
  @@index([statusId])
}

// ---

/// TeamMatch Model (Junction Table)
model TeamMatch {
  // Primary Key - Using Int as specified, auto-incremented
  id      Int @id @default(autoincrement())

  // Foreign Key to Match
  matchId String
  match   Match @relation(fields: [matchId], references: [id])

  teamId  Int
  team   Team @relation(fields: [teamId], references: [id])


  // Indexing on Foreign Keys for faster lookups/joins
  @@index([matchId])
  @@index([teamId])

  // Optional: Composite unique constraint if a team can only be associated once per match
  // @@unique([matchId, teamId])
}